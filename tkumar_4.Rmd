---
title: "ML Assignment 4"
output:
  pdf_document: default
  word_document: default
---
## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

Loading the Data
```{r}
rm(list = ls())

library(tidyverse)
#install.packages("factoextra")
library(factoextra)
library(ISLR)
set.seed(123)

DFUniver<-read.csv("Universities.csv")
colnames(DFUniver)
#summary(DFUniver)
DFUniver<-DFUniver%>%rename(
  Pub.Private=Public..1...Private..2.,
  ApplRec=X..appli..rec.d,
  ApplAccept=X..appl..accepted,
  NewStdEnr=X..new.stud..enrolled,
  Top10=X..new.stud..from.top.10.,
  Top25=X..new.stud..from.top.25.,
  FTUnderG=X..FT.undergrad,
  PTUnderG=X..PT.undergrad,
  InStateFee=in.state.tuition,
  OutStateFee=out.of.state.tuition,
  BookCost=estim..book.costs,
  PerCost=estim..personal..,
  PHD=X..fac..w.PHD,
  StFactRatio=stud..fac..ratio
)

colnames(DFUniver)
```
Removing missing records from the Dataset (Measurements)
```{r}
#Total NULL fields in the data frame 
count(DFUniver[!complete.cases(DFUniver),])

#Ipute the NULL values
DFUniver1<-na.omit(DFUniver) 

```

Finding the Data Summary and Measure of Dependence
```{r}
#Summary Data
summary(DFUniver1)

#Finding the correlation between the data set
#Selecting numerical columns only 

DFNumerical<-DFUniver1[,c(-1,-2)]
library(corrplot)
corrplot(cor(DFNumerical), method = "color")

```
In the correlation graph, Darker Blue and Dark Orange shows the higher correlated data. Using this data to understand any correlation among the column data.

Finding the K-means clustering values - Universities of Public & Private type and In State Fee Amount
```{r}
colnames(DFNumerical)
DFPubPriInState<-DFNumerical[,c(1,9)]

#Scaling the Data
DFPubPriInState<-scale(DFPubPriInState)

#Distance Between Observations
distance <- get_dist(DFPubPriInState)
fviz_dist(distance)

#Finding optimal number of clusters - Elbow Method
fviz_nbclust(DFPubPriInState, kmeans, method = "wss")

#From the Elbow method we can see that optimum no. of cluster size is 7, for this data set

#Clustering of In State Fee data with the relation between Public and Private Universities
k4 <- kmeans(DFPubPriInState, centers = 3, nstart = 25) # k = 3, number of restarts = 25

# Visualize the output

k4$centers # output the centers

#number of Universities in each cluster
k4$size

# Identify the cluster of the 120th observation as an example
k4$cluster[120]

# Visualize the output

fviz_cluster(k4, data = DFPubPriInState)
```
Making cluster on another data set - New Student Enroll and Out of State Fee
```{r}
colnames(DFNumerical)
DFEnrolOutStFee<-DFNumerical[,c(4,10)]

#Scaling the Data
DFEnrolOutStFee<-scale(DFEnrolOutStFee)

#Finding optimal number of clusters - Elbow Method
fviz_nbclust(DFEnrolOutStFee, kmeans, method = "wss")

#From the Elbow method we can see that optimum no. of cluster size is 4, for this data set

#Clustering of Out State Fee data with relation between Student Enroll by the Universities
k4 <- kmeans(DFEnrolOutStFee, centers = 5, nstart = 25) # k = 5, number of restarts = 25

# Visualize the output

k4$centers # output the centers

#number of Universities in each cluster
k4$size

# Identify the cluster of the 120th observation as an example
k4$cluster[120]

# Visualize the output

fviz_cluster(k4, data = DFEnrolOutStFee)
```
Making cluster on another data set - Student Application and Out of State Fee

```{r}
colnames(DFNumerical)
DFStAppOutStFee<-DFNumerical[,c(3,10)]

#Scaling the Data
DFStAppOutStFee<-scale(DFStAppOutStFee)

#Finding optimal number of clusters - Elbow Method
fviz_nbclust(DFStAppOutStFee, kmeans, method = "wss")

#From the Elbow method we can see that optimum no. of cluster size is 5, for this data set
k4 <- kmeans(DFStAppOutStFee, centers = 5, nstart = 25) # k = 5, number of restarts = 25

# Visualize the output

k4$centers # output the centers

#number of Universities in each cluster
k4$size

# Identify the cluster of the 120th observation as an example
k4$cluster[120]

# Visualize the output

fviz_cluster(k4, data = DFStAppOutStFee)
```



